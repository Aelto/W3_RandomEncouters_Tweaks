<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="../master.css"> -->
  <link rel="stylesheet" href="master.css">
  <title>In-depth install guide</title>
</head>

<body>

  <h1>In depth guide for installing Random Encounter Reworked</h1>

  <section class="summary">
    <ul>
      <li>
        <a href="#part-1">1.</a> first i will explain what each dependencies does and how to install them, and in which
        cases you should <b>not</b> install them.
        <ul>
          <li><a href="#part-1-2">1.1.</a> SharedImports</li>
          <li><a href="#part-1-2">1.2.</a> CommunityPatch - Base</li>
        </ul>
      </li>

      <li>
        <a href="#part-2">2.</a> then how to actually install Random Encounters Reworked.
      </li>

      <li>
        <a href="#part-3">3.</a> merging instructions for known conflicts
      </li>
    </ul>

    <hr />
    <ul>
      <li>
        <a href="#part-4">4.</a> <span>OPTIONAL:</span> you can also install keybinds if you want to trigger events by
        using your keyboard
        <ul>
          <li><a href="#part-4-1">4.1.</a> trigger an encounter</li>
          <li><a href="#part-4-2">4.2.</a> reload the settings</li>
          <li><a href="#part-4-3">4.3.</a> toggle RER</li>
          <li><a href="#part-4-4">4.4.</a> analyse the surrounding ecosystem</li>
        </ul>
      </li>
    </ul>

    <hr />
    <ul>
      <li><a href="#part-5">5.</a> Uninstalling Random Encounters Reworked</li>
    </ul>
  </section>

  <section id="part-1">
    <h2>Installing the dependencies</h2>
    <blockquote class="info">
      How to install the dependencies and why Random Encounters Reworked needs them, and in which cases you could skip
      this step.
    </blockquote>

    <div id="part-1-1">
      <h3>Dependency - Shared Imports</h3>

      <div>
        <h4>What is its role</h4>
        <div>
          It's a simple mod that imports tons of helper functions (things to interact with the game) so people don't
          have to.
          Because if two mods import the same function the game won't start and will give you an error, hence the name
          "Shared" imports.
        </div>
      </div>

      <div>
        <h4>When should you skip it?</h4>
        <div>
          If you've installed it already or if you have Witcher 3 Enhanced Edition. To check if you've installed it
          already go into <span>The Witcher 3/mods/</span> and look for a folder named <span>modSharedImports</span>
          If you find one skip this dependency.
        </div>
      </div>

      <div>
        <h4>How to install it?</h4>
        <div>
          <ol>
            <li>Go to <a href="https://www.nexusmods.com/witcher3/mods/2110/?tab=files">Shared Imports</a>' mod page
            </li>
            <li>Download <span>modSharedImports-v0.6</span></li>
            <li>Drop the content of the archive you downloaded directly into <span>The Witcher 3/</span> so that you
              merge the archive <span>mods</span> directory with your <span>mods</span> directory</li>
          </ol>
        </div>
      </div>
    </div>

    <div id="part-1-2">
      <h3>Dependency - CommunityPatch - Base</h3>

      <div>
        <h4>What is its role</h4>
        <div>
          Not all versions have the same code and somes helper functions were added to later versions. But if RER uses
          one of these functions while you're not on the latest version you won't be able to use my mod.
          This mod creates a "base" (clever name eh?) for mod makers so everyone can use their mods.
        </div>
      </div>

      <div>
        <h4>When should you skip it?</h4>
        <div>
          If you've installed it already, if you have Unification Patch or if you have GM/W3EE you may not need it. To
          check if you've installed CP-Base already go into <span>The Witcher 3/mods/</span> and look for a folder named
          <span>mod0000___CompilationTrigger</span>
          If you find one skip this dependency.
        </div>
      </div>

      <div>
        <h4>How to install it?</h4>
        <div>
          <ol>
            <li>Go to <a href="https://www.nexusmods.com/witcher3/mods/3652?tab=files">CP - Base</a>'s mod page</li>
            <li>Download <span>CommunityPatch-Base</span></li>
            <li>Drop the content of the archive you downloaded directly into <span>The Witcher 3/</span> so that you
              merge the archive <span>mods</span> directory with your <span>mods</span> directory and also the
              <span>content directory</span>
            </li>
            <li>Replace every file when prompted</li>
          </ol>
        </div>
      </div>
    </div>
  </section>

  <section id="part-2">
    <h2>Installing Random Encounters Reworked</h2>
    <blockquote class="info">
      How to actually install Random Encounters Reworked.
    </blockquote>


    <ol>
      <li>
        Download the latest v2 version: <a
          href="https://github.com/Aelto/tw3-random-encounters-reworked/releases/download/v2.13-pre-release_0/v2.13-pre-release_0.zip">direct
          download link</a>
      </li>
      <li>Drop the content of the archive into your <span>The Witcher 3</span> directory so that you merge the three
        directories <span>mods</span>/<span>bin</span>/<span>content</span> with those already here</li>
      <li>Merge the shared utils mods from RER with the script merger of your choice. The only exception is if you use
        the FHUD patch, let it win by priority</li>
    </ol>
  </section>

  <section id="part-3">
    <h2>Merging instructions</h2>
    <blockquote class="info">
      Merging instructions for known conflicts
    </blockquote>

    <details>
      <summary>Enhanced Edition</summary>
      <blockquote>
        Since EE comes with FHUD bundled-in it is necessary you also look at the
        Friendly HUD section below.
      </blockquote>

      <div>
        <h3>Files to merge</h3>
        <div>
          All of them will merge automatically, the names of the files in the merger are blue.
        </div>
        <ul>
          <li>
            <span>engine\component.ws</span>
            <ul>
              <li>mod_sharedutils_npcInteraction</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>engine\persistentEntity.ws</span>
            <ul>
              <li>mod_sharedutils_npcInteraction</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>game\gui\hud\modules\hudModuleDialog.ws</span>
            <ul>
              <li>mod_sharedutils_dialogChoices</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>game\gui\hud\modules\hudModuleMinimap2.ws</span>
            <ul>
              <li>mod_sharedutils_mappins</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>game\gui\menus\mapMenu.ws</span>
            <ul>
              <li>mod_sharedutils_mappins</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>game\player\r4Player.ws</span>
            <ul>
              <li>mod_sharedutils_mappins</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>game\gameplay\damage\damageManagerProcessor.ws</span>
            <ul>
              <li>mod_sharedutils_damagemodifiers</li>
              <li>modW3EE</li>
            </ul>
          </li>
          <li>
            <span>game\gameplay\npc\npc.ws</span>
            <ul>
              <li>mod_sharedutils_damagemodifiers</li>
              <li>modW3EE</li>
            </ul>
          </li>
        </ul>
      </div>
    </details>

    <details>
      <summary>Friendly HUD</summary>

      <div>
        <ul>
          <li>
            <span>playerInput.ws</span>
            <ul>
              <li>modFriendlyHUD</li>
              <li>mod_sharedutils_npcInteraction</li>
            </ul>
          </li>
        </ul>

        If a conflict between the two appears (the name of the file is in red),
        you should merge the files and wait until you are shown the conflict between
        the two given mods.

        <img src="npc_interaction_fhud_conflict.png" alt="image showing the kdiff3 between sharedutils and FHUD">
        <i>hold left click on the image to zoom</i>
      </div>

      <div>
        On the two top right panels you should see one panel
        for <span>sharedutils</span> and one for <span>Friendly HUD</span>. To
        confirm which panel is which mod you should read the comments in the code,
        the lines starting with <span>//</span>.
      </div>

      <div>
        Once you know which side is FHUD and which side is sharedutils, using the
        <span>B</span> and <span>C</span> letters on the top menu, you should first
        pick the sharedutils one and in second the FHUD one.
        <br>
        Refer to the screenshot to see the expected result in the bottom panel.
      </div>
    </details>
  </section>


  <section id="part-4">
    <h2>Adding the keyboard keybinds</h2>
    <blockquote class="info">
      What each keybind does and how to add them to your game
    </blockquote>

    <div id="part-4-1">
      <h3>Keybind - Trigger an encounter</h3>

      <div>
        <h4>What is its role?</h4>
        <div>
          When you press the key an encounter will be created by RER after a 5 seconds delay.
        </div>
      </div>

      <div>
        <h4>How to add it?</h4>
        <div>
          <ol>
            <li>Go to <span>Documents/The Witcher 3</span> and open <span>input.settings</span> with a text editor</li>
            <li>Search for <span>[Exploration]</span> and add a line below it with
              <span>IK_0=(Action=RandomEncounter)</span>
            </li>
            <li>You can replace the <span>0</span> in <span>IK_0</span> by the key you want, here it means the
              <span>0</span> of your keyboard
            </li>
          </ol>
        </div>
      </div>
    </div>

    <div id="part-4-2">
      <h3>Keybind - Reload the settings</h3>

      <div>
        <h4>What is its role?</h4>
        <div>
          When you change the settings you usually have to load a save for them to be applied. This keybind solves this
          by forcing a settings refresh without the need to load a save.
        </div>
      </div>

      <div>
        <h4>How to add it?</h4>
        <div>
          <ol>
            <li>Go to <span>Documents/The Witcher 3</span> and open <span>input.settings</span> with a text editor</li>
            <li>Search for <span>[Exploration]</span> and add a line below it with
              <span>IK_0=(Action=OnRefreshSettings)</span>
            </li>
            <li>You can replace the <span>0</span> in <span>IK_0</span> by the key you want, here it means the
              <span>0</span> of your keyboard
            </li>
          </ol>
        </div>
      </div>
    </div>

    <div id="part-4-3">
      <h3>Keybind - Toggle Random Encounters Reworked</h3>

      <div>
        <h4>What is its role?</h4>
        <div>
          Sometimes you want to stop RER from doing its job, you can go into the mod menu and set the
          <span>Enabled</span> toggle to OFF. This keybind can be used to toggle it without going to the mod menu
        </div>
      </div>

      <div>
        <h4>How to add it?</h4>
        <div>
          <ol>
            <li>Go to <span>Documents/The Witcher 3</span> and open <span>input.settings</span> with a text editor</li>
            <li>Search for <span>[Exploration]</span> and add a line below it with
              <span>IK_0=(Action=OnRER_enabledToggle)</span>
            </li>
            <li>You can replace the <span>0</span> in <span>IK_0</span> by the key you want, here it means the
              <span>0</span> of your keyboard
            </li>
          </ol>
        </div>
      </div>
    </div>

    <div id="part-4-4">
      <h3>Keybind - Analyse surrounding ecosystem</h3>

      <div>
        <h4>What is its role?</h4>
        <div>
          Geralt can analyse the surrounding ecosystem to get information about the creatures that live here and also
          offers
          advice on how to change the ecosystem.
        </div>
      </div>

      <div>
        <h4>How to add it?</h4>
        <div>
          <ol>
            <li>Go to <span>Documents/The Witcher 3</span> and open <span>input.settings</span> with a text editor</li>
            <li>Search for <span>[Exploration]</span> and add a line below it with
              <span>IK_C=(Action=EcosystemAnalyse,State=Duration,IdleTime=0.4)</span>
            </li>
            <li>You can replace the <span>C</span> in <span>IK_C</span> by the key you want, here it means the
              <span>C</span> of your keyboard
            </li>
            <li>Note that you need to press the key for 0.4s for it to trigger.</li>
          </ol>
        </div>
      </div>
    </div>
  </section>

  <section id="part-5">
    <h2>Uninstalling Random Encounters Reworked</h2>

    <details>
      <summary>Before removing RER</summary>

      <div>
        Run the commands:
        <ul class="spaced">
          <li><span>rercompletecontract</span></li>
          <li><span>rerabandonbounties</span></li>
          <li><span>reruninstall</span></li>
        </ul>

        Then <b>save your game</b>
      </div>
    </details>

    <details>
      <summary>Removing RER files</summary>

      <ul class="spaced">
        <li>
          In your <span>Mods</span> folder:
          <ul>
            <li>Remove all folders whose names start with <span>mod_sharedutils</span></li> (the amount of sharedutils
            mods may vary depending on the version)
            <li>Remove the <span>modRandomEncountersReworked</span> folder</li>
          </ul>
        </li>
        <li>
          In your <span>DLC</span> folder:
          <ul>
            <li>Remove <span>dlcsharedutils</span></li>
            <li>Remove <span>dlcModRandomEncountersReworked</span></li>
          </ul>
        </li>
        <li>
          In your <span>bin/config/r4game/user_config_matrix/pc</span> folder:
          <ul>
            <li>Remove <span>modRandomEncountersReworked.xml</span></li>
          </ul>
        </li>
      </ul>
    </details>

    <details>
      <summary>Removing community patches and shared dependencies</summary>

      <div>
        The following mods are shared dependencies. RER uses them but other could
        also need them, which means you may still need them after uninstalling RER.
      </div>

      <section>
        <h3>Community Patch - Base</h3>

        <div>
          This patch is often needed by big overhauls like Ghost Mode.
        </div>

        <ul>
          <li>
            In your <span>Mods</span> folder:
            <ul>
              <li>Remove <span>mod0000___CompilationTrigger</span> if you have any (RER's installer doesn't add it)</li>
            </ul>
          </li>
        </ul>

        Then head to the <a href="https://www.nexusmods.com/witcher3/mods/3652?tab=files">Community Patch - Base</a>'s
        files
        tab, in the optional section get the vanilla scripts that correspond to your version. Refer to the
        "Uninstallation"
        section of this mod to understand how to restore the vanilla scripts.
      </section>

      <p>
        Once all this is done, you can finally remerge your scripts.
      </p>
    </details>
  </section>
</body>

</html>